import { writable } from 'svelte/store';
import { auth } from '$lib/stores/auth.store';

export const form = writable({
  email: '',
  password: ''
});

export const loading = writable(false);
export const error = writable<string | null>(null);

export async function submit() {
  loading.set(true);
  error.set(null);

  const { email, password } = get(form);

  try {
    await auth.login(email, password);
    window.location.href = '/';
  } catch (e: any) {
    error.set(e?.message ?? 'Error de autenticaci√≥n');
  } finally {
    loading.set(false);
  }
}
